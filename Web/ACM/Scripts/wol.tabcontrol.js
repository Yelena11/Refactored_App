//
// Copyright (c) Microsoft Corporation.  All rights reserved.
//

typeof Ms=="undefined"&&(Ms={}),typeof Ms.Wol=="undefined"&&(Ms.Wol={}),typeof Ms.Wol.TabControl=="undefined"&&(Ms.Wol.TabControl={}),Ms.Wol.TabControl=function(){function t(){typeof Sys!="undefined"&&typeof Sys.WebForms!="undefined"&&typeof Sys.WebForms.PageRequestManager!="undefined"&&(Sys.WebForms.PageRequestManager.getInstance().add_pageLoaded(function(){jQuery("."+n._sControlClass).each(function(){jQuery("#"+jQuery(this).attr("id")+" ."+n._sTabCntClass+" ."+n._sNavLnkClass).click(function(){return Ms.Wol.TabControl.CaptureContentLink(this,jQuery(this).parents("."+n._sControlClass))}),jQuery("#"+jQuery(this).attr("id")+" a."+n._sTcPrevClass).click(function(){return n._AttachTabChanger(jQuery(this)),!1}),jQuery("#"+jQuery(this).attr("id")+" a."+n._sTcNextClass).click(function(){return n._AttachTabChanger(jQuery(this)),!1})})}),Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(function(t,i){var r=i.get_postBackElement().id;typeof r!="undefined"&&jQuery("#"+r).hasClass(n._sTabClass)&&(n._sPostBackOriginElementId=r,n._sPostBackOriginCtrlId=jQuery("#"+r).parents("."+n._sControlClass).get(0).id)}),Sys.WebForms.PageRequestManager.getInstance().add_endRequest(function(){if(n._sPostBackOriginCtrlId!=null&&n._sPostBackOriginElementId!=null){var r=jQuery("#"+n._sPostBackOriginElementId),u=jQuery("#"+n._sPostBackOriginCtrlId+" ."+n._sTabCntClass);n._ShowTab(r,u,!0),n._sPostBackOriginElementId=null,n._sPostBackOriginCtrlId=null}})),jQuery("."+n._sControlClass).each(function(){var i=jQuery(this).find("."+n._sSelTabClass),r=jQuery(this).find("."+n._sTabCntClass),t;if(n._UpdSelTabIdTbl(jQuery(this),i),n._sCurrentQuery.indexOf(jQuery(this).attr(n._sBaseIdAttrName).toLowerCase())<0&&Ms.Wol.Cookies!=null&&(t=Ms.Wol.Cookies.GetCookie(jQuery(this).attr(n._sBaseIdAttrName)),t!=null&&jQuery(this).find("#"+t).length>0&&!jQuery(this).find("#"+t).hasClass(n._sSelTabClass))){Ms.Wol.TabControl.ChangeTab(jQuery(this).find("#"+t));return}n._ShowTab(i,r)}),jQuery("a."+n._sTabClass).click(function(){return n._AttachTab(jQuery(this)),!1})}jQuery(document).ready(t);var n={_sCurrentQuery:location.search.toLowerCase(),_sControlClass:"tabBody",_sTabClass:"tabLink",_sSelTabClass:"tabLinkSelected",_sTcPrevClass:"tabChangerLinkPrevious",_sTcNextClass:"tabChangerLinkNext",_sTcDsblClass:"tabChangerDisabled",_sNavLnkClass:"navigationLink",_sTabCntClass:"tabContent",_sTabCntEnblClass:"tabContentEnabled",_sTabLnkEnblClass:"tabLinkEnabled",_sBaseIdAttrName:"data-baseid",_sTgtIdAttrName:"data-targetelementid",_iPbRetryWaitMs:100,_iPbRetryMaxMs:1e4,_aSelTabIdTbl:[],_sPostBackOriginCtrlId:null,_sPostBackOriginElementId:null,_UpdSelTabIdTbl:function(n,t){if(n!=null&&t!=null){var i=jQuery(n),r=jQuery(t);i.attr("id")!=null&&r.attr("id")!=null&&i.attr(this._sBaseIdAttrName)!=null&&r.attr(this._sBaseIdAttrName)!=null&&(this._aSelTabIdTbl[i.attr(this._sBaseIdAttrName)]=[i.attr("id"),r.attr(this._sBaseIdAttrName),r.attr("id")])}},_ParseTargetUrl:function(n,t){if(n!=null){var r=new RegExp(".*\\?.*?"+t+"=([a-z0-9]*?)(?:&.*)?$","i"),i=r.exec(n);if(i!=null&&i.length>1)return i[1]}return null},_AttachTab:function(n){typeof n!="undefined"&&n.hasClass(this._sTabClass)&&(n.hasClass(this._sSelTabClass)||Ms.Wol.TabControl.ChangeTab(n))},_AttachTabChanger:function(n){if(!n.hasClass(this._sTcDsblClass)){var t=n.attr(this._sTgtIdAttrName);typeof t!="undefined"&&Ms.Wol.TabControl.ChangeTab(jQuery("#"+t))}},_TabChange:function(n){Ms.Wol.TabControl.TabChangeEvent.Raise(n)},_ShowTab:function(t,i,r){t.addClass(n._sTabLnkEnblClass),i.addClass(n._sTabCntEnblClass),i.css("visibility","visible"),r==!0&&typeof Wol!="undefined"&&typeof Wol.ContentInstrumentation!="undefined"&&typeof Wol.ContentInstrumentation.Logging!="undefined"&&Wol.ContentInstrumentation.Logging.LogImpressions(i.get(0))}};return{CaptureContentLink:function(t,i){if(t!=null&&i!=null){var e=jQuery(t),u=jQuery(t).attr("href"),f=!1,o=null,r=null;if(u==null||(r=n._ParseTargetUrl(u,i.attr(n._sBaseIdAttrName)),r==null))return!0;if(jQuery("#"+i.attr("id")+" ."+n._sTabClass).each(function(){if(jQuery(this).attr(n._sBaseIdAttrName).toLowerCase()==r.toLowerCase())return jqoTargetElement=jQuery(this),f=!0,!1}),f)return Ms.Wol.TabControl.ChangeTab(jqoTargetElement),!1}return!0},ChangeTab:function(t){if(typeof t!="undefined"){n._TabChange(t.get(0));var r=t.parents("."+n._sControlClass),i=r.attr(n._sBaseIdAttrName),u=jQuery("#"+n._aSelTabIdTbl[i][2]);u.removeClass(n._sSelTabClass),u.removeClass(n._sTabLnkEnblClass),t.addClass(n._sSelTabClass),i!=null&&n._UpdSelTabIdTbl(r,t),Ms.Wol.Cookies.SetCookie(i,t.attr("id")),Ms.Wol.TabControl.TryPostBack(t.attr("id"))}},TryPostBack:function(t,i){if(t!=null&&(i==null&&(i=0),i<n._iPbRetryMaxMs)){var r=Sys.WebForms.PageRequestManager.getInstance().get_isInAsyncPostBack();r==!0?setTimeout(function(){Ms.Wol.TabControl.TryPostBack(t,i+n._iPbRetryWaitMs)},n._iPbRetryWaitMs):__doPostBack(t.replace(/_/g,"$"),"")}},NoOp:function(){},TabChangeEvent:new Wol.Util.CustomEvent}}();